{{ define "main" }}
<div id="photos" class="post-list">
    {{ range where .Pages "Section" "photos" }}
	{{ $srcBase := .Site.Params.photos_uri }}
	{{ $srcFile := index (findRE "^([^.]+)" .Params.src 1) 0 }}
	{{ $srcExt := index (findRE "\\.[^.]*$|$" .Params.src 1) 0 }}
	{{ $srcType := replaceRE ".jpg" "jpeg" $srcExt }}
	<div class="photo-frame">
	    <a href="{{ .Permalink }}">
		<picture style="max-width:100%;height:auto;">
		    <source srcset="{{ $srcBase }}/{{ $srcFile }}-640.webp 640w" alt="{{ .Title }}" type="image/webp">
		    <source srcset="{{ $srcBase }}/{{ $srcFile }}-640{{ $srcExt }} 640w" alt="{{ .Title }}" type="image/{{ $srcType }}">
		    <img src="{{ $srcBase }}/{{ $srcFile }}-640{{ $srcExt }}" alt="{{ .Title }}" width="100%" height="auto">
		</picture>
	    </a>
	</div>
    {{ end }}
</div>
<style>
    main#content {
	max-width: 100%;
    }

    main#content .post-list {
	grid-column-gap: 10px;
	grid-row-gap: 10px;
    }

    div#photos {
	display: grid;
	grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    }

    div .photo-frame {
	display: flex;
	align-items:center;
	object-fit: scale-down;
    }
</style>
{{ end }}
